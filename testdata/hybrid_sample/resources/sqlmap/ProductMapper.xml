<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.company.modern.ProductMapper">
    
    <!-- 상품 등록 -->
    <insert id="insertProduct" parameterType="com.company.common.ProductDTO">
        INSERT INTO tb_product (
            product_name,
            category,
            price,
            stock_quantity,
            description,
            created_at
        ) VALUES (
            #{productName},
            #{category},
            #{price},
            #{stockQuantity},
            #{description},
            NOW()
        )
    </insert>
    
    <!-- 전체 상품 조회 -->
    <select id="selectAllProducts" resultType="com.company.common.ProductDTO">
        SELECT 
            product_id AS productId,
            product_name AS productName,
            category,
            price,
            stock_quantity AS stockQuantity,
            description
        FROM tb_product
        WHERE use_yn = 'Y'
        ORDER BY product_id DESC
    </select>
    
    <!-- 키워드로 상품 검색 -->
    <select id="selectProductsByKeyword" parameterType="string" 
            resultType="com.company.common.ProductDTO">
        SELECT 
            product_id AS productId,
            product_name AS productName,
            category,
            price,
            stock_quantity AS stockQuantity,
            description
        FROM tb_product
        WHERE use_yn = 'Y'
          AND (
              product_name LIKE CONCAT('%', #{keyword}, '%')
              OR description LIKE CONCAT('%', #{keyword}, '%')
          )
        ORDER BY product_id DESC
    </select>
    
</mapper>
